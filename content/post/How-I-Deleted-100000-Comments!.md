---
title: "How I Deleted 100000 Comments!"
date: 2011-05-23T17:44:00.0000000
draft: false
featured_image: ""
---

<p>Finally, no spam! My blog was slowly becoming dysfunctional, after getting more than 2000 spam comments per day!</p>  <p>I moved to the new version 2.0 of <a href="http://dotnetblogengine.net">http://dotnetblogengine.net</a> last night, and it has super easy built in <a href="http://recaptcha.org">reCAPTCHA</a> which stops spam and helps read books. Pretty cool! The reCAPTCHA settings are accessed by hovering over Tools and selecting Edit in .NET Blog Engine 2.0 – it was very hard and non-intuitive to find the setting, but once I did it worked like a charm!</p>  <p>There was one &quot;small glitch&quot; though – about a hundred thousand spam comments left to &quot;moderate&quot;, which I did.</p>  <p>&#160;</p>  <p>   <table border="0" cellspacing="0" cellpadding="2" width="796"><tbody>       <tr>         <td valign="top" width="406"><a href="/peace.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="peace" border="0" alt="peace" src="/peace_thumb.jpg" width="400" height="400" /></a></td>          <td valign="top" width="388">Now I feel at peace like the picture on the left</td>       </tr>     </tbody></table> </p>  <p>I made a small program, which anyone can use to mass-delete blog engine’s comments after specific date. Hopefully this will help anyone unspam themselves.</p>  <p>[code:c#]</p>  <p>private void button1_Click(object sender, RoutedEventArgs e)    <br />{     <br />&#160;&#160;&#160; string[] files = Directory.GetFiles(@&quot;D:\TEMP\blog\App_Data\posts&quot;, &quot;*.xml&quot;);     <br />&#160;&#160;&#160; foreach (string file in files)     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; FixPost(file);     <br />&#160;&#160;&#160; }     <br />}</p>  <p>private void FixPost(string fileName)    <br />{     <br />&#160;&#160;&#160; XDocument doc;     <br />&#160;&#160;&#160; using (FileStream stream = File.OpenRead(fileName))     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc = XDocument.Load(stream);     <br />&#160;&#160;&#160; }</p>  <p>&#160;&#160;&#160; var list = from XElement el in doc.Descendants(XName.Get(&quot;comment&quot;, String.Empty))&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; select el;     <br /></p>  <p>&#160;&#160;&#160; // convert the list to an array so that we're not modifying the collection that we're iterating over&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; XName date = XName.Get(&quot;date&quot;);     <br />&#160;&#160;&#160; foreach (XElement el in list.ToArray())     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; string data = ((XElement)el.FirstNode).Value;</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (data.StartsWith(&quot;2011&quot;) || data.StartsWith(&quot;2010-12&quot;) || data.StartsWith(&quot;2010-11&quot;) || data.StartsWith(&quot;2010-10&quot;))    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; el.Remove();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160; }</p>  <p>&#160;&#160;&#160; using (XmlWriter writer = XmlWriter.Create(fileName))    <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.WriteTo(writer);     <br />&#160;&#160;&#160; }     <br />}</p>  <p>[/code]</p>  <p>That code deleted all comments from Oct 2010 onward (sorry, I had to do it), but yay! No spam! I can finally blog normally. <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/wlEmoticon-smile_7.png" /></p>  <p>Hope you like it! Please comment in a nice and clean environment! <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/wlEmoticon-smile_7.png" /></p>