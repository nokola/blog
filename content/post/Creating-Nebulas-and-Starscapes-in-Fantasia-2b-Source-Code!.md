---
title: "Creating Nebulas and Starscapes in Fantasia + Source Code!"
date: 2010-10-27T12:17:03.0000000
draft: false
featured_image: ""
---

<p>Yes! I just released support for new type of filters in <a href="http://fantasia.nokola.com/">Fantasia</a> that I called Creations. The first, Nebula Creation, allows me do to starry background images like this (source code below):</p>  <p><strong>Update: </strong>shortly after releasing the source code I noticed the nebula image was fixed (only the opacity mask was varying), fixed it and uploaded again.</p>  <p><a href="/nebula1.jpg"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="nebula1" border="0" alt="nebula1" src="/nebula1_thumb.jpg" width="804" height="604" /></a></p>  <p>Or this:</p>  <p><a href="/nebula2.jpg"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="nebula2" border="0" alt="nebula2" src="/nebula2_thumb.jpg" width="804" height="604" /></a></p>  <p>If you’d like to try for yourself, open Fantasia now (<a href="http://fantasia.nokola.com">http://fantasia.nokola.com</a>) and go to Creations (after Effects). </p>  <p><a href="http://fantasia.nokola.com/"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/image_32.png" width="244" height="229" /></a></p>  <p>The first one is done by creating a nebula with no stars (set to zero), then Tint, then add stars. The second one is just the Nebula generator <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/wlEmoticon-smile_1.png" /> I find both very usable for space shooter games <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/wlEmoticon-smile_1.png" /></p>  <p>The Creation filters work with the selection brush, and you can easily sprinkle some stars on an image:</p>  <p>Original:</p>  <p><a href="/starBefore.jpg"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="starBefore" border="0" alt="starBefore" src="/starBefore_thumb.jpg" width="516" height="346" /></a></p>  <p>Starry night:</p>  <p><a href="/starAfter.jpg"><img style="background-image: none; border-right-width: 0px; margin: ; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="starAfter" border="0" alt="starAfter" src="/starAfter_thumb.jpg" width="516" height="346" /></a></p>  <p>The starry night version looks much more interesting…just waiting for few comets to pop up! Original image is from here: <a title="http://www.flickr.com/photos/dagoaty/4360363431/" href="http://www.flickr.com/photos/dagoaty/4360363431/">http://www.flickr.com/photos/dagoaty/4360363431/</a></p>  <p>I also made a small sample that has just the Nebula generator: <a href="http://nokola.com/nebula">http://nokola.com/nebula</a>&#160;</p>  <p><a href="http://nokola.com/sources/nebula.zip">Download source code</a></p>  <p>I used lots of various sources on perlin noise (like Ken Perlin’s homepage and multiple algorithms for noise), until I got to the current version. It’s optimized to use integer numbers (fixed point calculations) throughout.</p>  <p>A little bit on the algorithm: the important part of the logic is drawing a low-frequency noise (freq = 2) on screen by masking it’s opacity with exponentially filtered high frequency noise (freq = 7). Thus, the low frequency noise becomes a smooth nebula, and the high frequency noise tells “if there’s nebula on screen or not”. In the source code there are a lot of internal parameters to play with.</p>  <p>Hope you like it! Please comment!</p>